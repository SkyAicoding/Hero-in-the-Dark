# HERO IN THE DARK - Game Design Document
### 횡스크롤 액션 RPG | Web-Based
**Version:** 1.0
**Date:** 2026-02-19
**Engine:** Phaser 3 (HTML5/WebGL)
**Platform:** Web Browser (PC/Mobile)

---

## TABLE OF CONTENTS

1. [게임 개요 (Game Overview)](#1-게임-개요)
2. [개발 플랫폼 및 기술 스택](#2-개발-플랫폼-및-기술-스택)
3. [핵심 게임플레이 루프](#3-핵심-게임플레이-루프)
4. [월드 & 스테이지 설계](#4-월드--스테이지-설계)
5. [캐릭터 시스템](#5-캐릭터-시스템)
6. [전투 시스템](#6-전투-시스템)
7. [몬스터 시스템](#7-몬스터-시스템)
8. [자원 채굴 & 조합 시스템](#8-자원-채굴--조합-시스템)
9. [성장 시스템](#9-성장-시스템)
10. [HUD & UI 설계](#10-hud--ui-설계)
11. [사운드 & 이펙트](#11-사운드--이펙트)
12. [데이터 저장 & 배포](#12-데이터-저장--배포)
13. [에셋 매핑 테이블](#13-에셋-매핑-테이블)
14. [개발 로드맵](#14-개발-로드맵)

---

## 1. 게임 개요

### 1.1 컨셉

> *"어둠이 내려앉은 고대의 숲, 한 명의 전사가 빛을 되찾기 위해 일어선다."*

**Hero in the Dark**은 **횡스크롤 액션 RPG**로, 플레이어는 은발의 전사가 되어
타락한 고대 숲을 탐험하고, 자원을 채굴하고, 장비를 조합하며,
점점 강해지는 몬스터들을 물리치고 숲의 핵심에 있는 어둠의 근원을 파괴하는 것이 목표입니다.

### 1.2 장르
- **Primary:** 횡스크롤 액션 플랫포머
- **Secondary:** RPG (성장/조합/탐험)
- **Inspiration:** Hollow Knight + Terraria + MapleStory

### 1.3 핵심 재미 요소

| 요소 | 설명 |
|------|------|
| **전투의 쾌감** | 타격감 있는 검술 액션, 적의 패턴 학습과 회피 |
| **탐험의 보상** | 숨겨진 동굴, 비밀 자원, 새로운 구역 발견 |
| **성장의 만족감** | 레벨업, 스탯 강화, 새로운 스킬 습득 |
| **조합의 중독성** | 채굴한 자원으로 더 강력한 장비와 포션 제작 |
| **도전의 긴장감** | 보스 몬스터, 위험한 구역, 생존의 스릴 |

### 1.4 타겟 플레이어
- 캐주얼~미드코어 게이머
- 점심시간 또는 이동 중 짧게 즐길 수 있는 세션 (15~30분)
- 웹 브라우저에서 바로 접속 가능 → 설치 불필요

---

## 2. 개발 플랫폼 및 기술 스택

### 2.1 왜 Phaser 3인가?

| 비교 항목 | Phaser 3 | Unity WebGL | Godot HTML5 |
|-----------|----------|-------------|-------------|
| **초기 로딩** | 매우 빠름 (~2초) | 느림 (~10초+) | 보통 (~5초) |
| **번들 사이즈** | ~1MB | ~20MB+ | ~10MB+ |
| **2D 픽셀아트 최적화** | 최고 | 과도함 | 좋음 |
| **웹 네이티브** | 네이티브 JS | 변환 필요 | 변환 필요 |
| **모바일 브라우저** | 우수 | 제한적 | 보통 |
| **핫 업데이트** | 즉시 배포 | 재빌드 필요 | 재빌드 필요 |
| **학습 곡선** | 낮음 | 높음 | 중간 |

**결론:** 픽셀아트 2D 횡스크롤 + 웹 즉시 배포 + 빠른 업데이트 = **Phaser 3 최적**

### 2.2 기술 아키텍처

```
┌─────────────────────────────────────────────────┐
│                 CLIENT (Browser)                 │
├─────────────────────────────────────────────────┤
│  Phaser 3        │  UI Layer                    │
│  ├─ WebGL Renderer  ├─ HUD (HP, EXP, Items)    │
│  ├─ Arcade Physics   ├─ Inventory Panel         │
│  ├─ Tilemap Engine   ├─ Crafting Panel          │
│  ├─ Animation Mgr    └─ Dialog System           │
│  └─ Scene Manager                                │
├─────────────────────────────────────────────────┤
│  Game Logic Layer                                │
│  ├─ PlayerController    ├─ CombatSystem         │
│  ├─ EnemyAI             ├─ CraftingSystem       │
│  ├─ InventorySystem     ├─ ProgressionSystem    │
│  └─ ResourceManager     └─ SaveSystem           │
├─────────────────────────────────────────────────┤
│  Data Persistence                                │
│  ├─ LocalStorage (오프라인 세이브)               │
│  └─ Optional: Firebase/Supabase (클라우드 동기화)│
└─────────────────────────────────────────────────┘
```

### 2.3 프로젝트 구조

```
Hero in the Dark/
├── Assets/                          # 원본 에셋 (현재 준비됨)
│   └── Legacy-Fantasy - High Forest 2.3/
├── public/                          # 게임에 사용할 최적화된 에셋
│   ├── sprites/
│   │   ├── player/                  # 캐릭터 스프라이트시트
│   │   ├── enemies/                 # 몬스터 스프라이트시트
│   │   ├── environment/             # 타일, 배경, 나무
│   │   └── ui/                      # HUD, 아이콘
│   ├── maps/                        # Tiled 에디터 JSON 맵 파일
│   ├── audio/                       # 효과음, BGM
│   └── data/                        # 아이템, 레시피, 몬스터 데이터 JSON
├── src/
│   ├── main.js                      # Phaser 게임 설정 & 진입점
│   ├── scenes/
│   │   ├── BootScene.js             # 에셋 로딩
│   │   ├── TitleScene.js            # 타이틀 화면
│   │   ├── ForestScene.js           # 숲 스테이지
│   │   ├── CaveScene.js             # 동굴 스테이지
│   │   ├── RuinsScene.js            # 유적 스테이지
│   │   ├── LakeScene.js             # 호수 스테이지
│   │   └── HiveScene.js             # 벌집 보스 스테이지
│   ├── entities/
│   │   ├── Player.js                # 플레이어 클래스
│   │   ├── Boar.js                  # 멧돼지 AI
│   │   ├── SmallBee.js              # 꿀벌 AI
│   │   └── Snail.js                 # 달팽이 AI
│   ├── systems/
│   │   ├── CombatSystem.js          # 전투 처리
│   │   ├── InventorySystem.js       # 인벤토리
│   │   ├── CraftingSystem.js        # 조합
│   │   ├── ProgressionSystem.js     # 성장/레벨업
│   │   └── SaveSystem.js            # 저장/불러오기
│   ├── ui/
│   │   ├── HUD.js                   # 인게임 HUD
│   │   ├── InventoryUI.js           # 인벤토리 UI
│   │   └── CraftingUI.js            # 조합 UI
│   └── utils/
│       ├── Constants.js             # 상수 정의
│       └── Helpers.js               # 유틸 함수
├── index.html                       # 게임 진입 HTML
├── package.json                     # 의존성 관리
├── vite.config.js                   # Vite 번들러 설정
└── GDD-Hero-in-the-Dark.md          # 이 문서
```

### 2.4 개발 도구 체인

| 도구 | 용도 |
|------|------|
| **Vite** | 번들링 & 핫리로드 개발 서버 |
| **Phaser 3.80+** | 게임 엔진 |
| **Tiled Map Editor** | 타일맵 스테이지 설계 |
| **Vercel / Netlify** | 무료 웹 호스팅 & 자동 배포 |
| **GitHub** | 버전 관리 & CI/CD |
| **LocalStorage + IndexedDB** | 게임 세이브 데이터 |

### 2.5 배포 & 업데이트 전략

```
개발자 PC → git push → GitHub → Vercel 자동 빌드 → 전세계 CDN 배포
                                                      ↓
                                          players.herointhedark.com
                                          (즉시 접속, 항상 최신 버전)
```

- **무중단 배포:** `git push`만 하면 30초 내 전세계 반영
- **모바일 대응:** PWA(Progressive Web App) 설정으로 홈 화면 추가 가능
- **오프라인 지원:** Service Worker로 캐싱 → 지하철에서도 플레이 가능

---

## 3. 핵심 게임플레이 루프

### 3.1 세션 루프 (15~30분)

```
    ┌──────────────────────────────────────────────┐
    │                                              │
    ▼                                              │
 [마을/거점]                                       │
    │ 장비 장착, 포션 제작, 상점                    │
    ▼                                              │
 [스테이지 선택]                                   │
    │ 숲 → 동굴 → 유적 → 호수 → 벌집              │
    ▼                                              │
 [탐험 & 전투]  ←──── 반복 ────┐                   │
    │ 몬스터 처치, 자원 채굴      │                  │
    │ 경험치 획득, 아이템 드롭    │                  │
    ▼                           │                  │
 [자원 충분?] ──── No ────────→┘                   │
    │ Yes                                          │
    ▼                                              │
 [보스 도전]                                       │
    │ 승리 시 다음 구역 해금                        │
    ▼                                              │
 [귀환] ──────────────────────────────────────────→┘
    세이브, 조합, 강화
```

### 3.2 코어 메카닉 삼각형

```
         ⚔️ 전투
        /      \
       /   FUN   \
      /____________\
   ⛏️ 채굴     🔨 조합
```

- **전투 → 채굴:** 강한 몬스터를 물리쳐야 새로운 채굴 구역에 접근
- **채굴 → 조합:** 채굴한 원석/약초로 무기/방어구/포션 조합
- **조합 → 전투:** 더 강한 장비로 더 어려운 전투에 도전

---

## 4. 월드 & 스테이지 설계

### 4.1 월드맵 구성

게임은 하나의 연결된 세계이지만, 5개의 뚜렷한 구역으로 나뉩니다:

```
                    [벌집 둥지] ← 최종 보스
                         ↑
    [호수 지대] ←→ [고대 유적]
         ↑              ↑
    [깊은 동굴] ←→ [울창한 숲] ← 시작 지점
```

### 4.2 스테이지 상세

#### Stage 1: 울창한 숲 (The Deep Forest)
- **에셋:** `Forest Tiles`, `Green-Tree`, `Dark-Tree`, `Background`
- **분위기:** 빽빽한 나무숲, 나뭇잎 사이로 비치는 햇살, 안개
- **구조:** 넓은 평지 + 언덕 + 나무 위 플랫폼
- **몬스터:** 멧돼지 (Lv.1~3), 달팽이 (Lv.1~2)
- **채굴 자원:** 나뭇가지, 약초, 작은 돌
- **특수 요소:**
  - 파괴 가능한 덤불 뒤 숨겨진 통로
  - 나무 꼭대기에 숨겨진 보물상자
  - 폭포 뒤 비밀 동굴 입구
- **BGM 분위기:** 평화롭지만 약간의 긴장감, 새소리와 바람 소리

#### Stage 2: 깊은 동굴 (The Dark Cavern)
- **에셋:** `Cave Tiles`, `Props-Rocks` (바위/광석), `Rune Stones`
- **분위기:** 어두운 동굴, 빛나는 광석, 떨어지는 물방울
- **구조:** 수직 탐험 + 좁은 통로 + 넓은 채굴장
- **몬스터:** 달팽이 (Lv.3~5) - 어둠 속에서 갑자기 등장(Hide→Appear)
- **채굴 자원:** 철광석, 구리, 수정, 루비 원석
- **특수 요소:**
  - 횃불이 없으면 시야 제한 (화면 가장자리 어둠 효과)
  - 무너지는 바닥 (시간 제한 플랫폼)
  - 광차 레일을 타고 이동하는 구간
- **BGM 분위기:** 에코 있는 물방울, 낮은 웅웅거림

#### Stage 3: 고대 유적 (The Ancient Ruins)
- **에셋:** `Ruins Tiles`, `Props-Rocks`(룬 스톤), `Buildings`
- **분위기:** 무너진 고대 문명, 이끼 낀 석조물, 신비로운 룬 문자
- **구조:** 거대한 유적 구조물 위/아래 탐험, 퍼즐 요소
- **몬스터:** 멧돼지 (Lv.5~7, 강화형), 꿀벌 (Lv.4~6)
- **채굴 자원:** 고대 룬석, 마력 결정, 금
- **특수 요소:**
  - 룬 스톤 퍼즐 (올바른 순서로 활성화)
  - 움직이는 석조 플랫폼
  - 고대 대장간 발견 → 고급 조합 레시피 해금
- **BGM 분위기:** 신비로운 코러스, 고대의 울림

#### Stage 4: 호수 지대 (The Crystal Lake)
- **에셋:** `Lake Tiles`, `Golden-Tree`, `Yellow-Tree`, `Red-Tree`
- **분위기:** 맑은 호수, 황금빛 나무들, 낙엽이 흩날림
- **구조:** 수면 위/아래 탐험, 떠다니는 나뭇잎 플랫폼
- **몬스터:** 꿀벌 (Lv.6~8), 멧돼지 엘리트 (Lv.7~9)
- **채굴 자원:** 호수 진주, 수련 잎, 황금 원석
- **특수 요소:**
  - 수중 탐험 구간 (산소 게이지)
  - 보트를 타고 이동하는 구간
  - 비밀 수중 동굴
- **BGM 분위기:** 잔잔한 물 소리, 평화롭지만 웅장한 멜로디

#### Stage 5: 벌집 둥지 (The Great Hive) — BOSS STAGE
- **에셋:** `Bees Nest Tiles`, `Hive`, `Small Bee`
- **분위기:** 거대한 벌집 내부, 흘러내리는 꿀, 수천 마리 벌의 윙윙거림
- **구조:** 벌집 육각형 구조, 수직/수평 복합 탐험
- **몬스터:** 꿀벌 대군 (Lv.8~10), **여왕벌 보스**
- **채굴 자원:** 로열 젤리, 순수 꿀, 벌침 독
- **특수 요소:**
  - 끈적한 꿀 바닥 (이동속도 감소)
  - 벌집 벽 파괴하여 지름길 생성
  - 최종 보스 전: 여왕벌 (다단계 페이즈)
- **BGM 분위기:** 긴박한 윙윙거림, 점점 고조되는 전투 음악

### 4.3 패럴랙스 배경 시스템

에셋의 다층 배경을 활용한 깊이감 있는 배경 스크롤:

```
Layer 0 (최후방): Sky              - Background.png 상단 (하늘)    - 스크롤 x0.0
Layer 1:          Distant Mountains - Trees/Background.png (산/숲)  - 스크롤 x0.1
Layer 2:          Far Trees         - Trees/Background.png (나무)   - 스크롤 x0.3
Layer 3:          Near Trees        - Color Trees (개별 나무)       - 스크롤 x0.5
Layer 4 (전경):   Game World        - Tiles.png (타일맵)           - 스크롤 x1.0
Layer 5:          Foreground FX     - 나뭇잎 파티클, 안개          - 스크롤 x1.2
```

---

## 5. 캐릭터 시스템

### 5.1 기본 정보

- **이름:** 미정 (플레이어가 지정)
- **외형:** 은발의 전사, 검과 방패를 든 경장 전사
- **설정:** 숲의 수호자 가문의 마지막 후예, 타락한 숲을 정화하기 위해 모험

### 5.2 애니메이션 스테이트 머신

```
                         ┌─────────┐
                    ┌───→│  IDLE   │←───┐
                    │    │ (4 Frames)│    │
                    │    └────┬────┘    │
               착지  │         │ 이동키  │ 정지
                    │    ┌────▼────┐    │
                    │    │   RUN   │────┘
                    │    │(8 Frames)│
                    │    └────┬────┘
                    │         │ 점프키
                    │    ┌────▼────┐
                    │    │  JUMP   │
                    │    │ START   │
                    │    │(4 Frames)│
                    │    └────┬────┘
                    │         │ 자동전환
                    │    ┌────▼────┐
                    │    │   AIR   │←──── 공중 공격 가능
                    │    │  JUMP   │
                    │    │(8 Frames)│
                    │    └────┬────┘
                    │         │ 착지 감지
                    │    ┌────▼────┐
                    └────│  JUMP   │
                         │   END   │
                         │(4 Frames)│
                         └─────────┘

  어디서든 공격키 →  ┌──────────┐
                    │ ATTACK-01│ → IDLE로 복귀
                    │(8 Frames)│
                    └──────────┘

  HP 0 →            ┌──────────┐
                    │   DIE    │ → Game Over
                    │(8 Frames)│
                    └──────────┘
```

### 5.3 조작 체계

| 입력 | 키보드 | 모바일 | 동작 |
|------|--------|--------|------|
| 이동 | ← → (A/D) | 가상 조이스틱 | 좌/우 이동 |
| 점프 | Space / W | 점프 버튼 | 점프 (공중 1회 추가 가능) |
| 공격 | J / Z | 공격 버튼 | 검 공격 |
| 채굴 | K / X | 채굴 버튼 | 근처 자원 노드 채굴 |
| 인벤토리 | I / Tab | 인벤토리 아이콘 | 인벤토리 열기 |
| 조합 | C | 조합 아이콘 | 조합창 열기 |
| 상호작용 | E / ↑ | 상호작용 버튼 | NPC대화, 문 열기 등 |

### 5.4 물리 파라미터

```javascript
// 캐릭터 물리 상수
const PLAYER_CONFIG = {
    // 이동
    MOVE_SPEED: 160,           // 기본 이동 속도 (px/s)
    ACCELERATION: 800,         // 가속도
    DECELERATION: 1200,        // 감속도 (멈출 때 미끄러짐 최소화)

    // 점프
    JUMP_FORCE: -320,          // 점프력 (위 방향)
    AIR_JUMP_FORCE: -260,      // 공중 점프력 (약간 약함)
    GRAVITY: 800,              // 중력
    MAX_JUMPS: 2,              // 최대 점프 횟수 (이중 점프)
    COYOTE_TIME: 80,           // 코요테 타임 (ms) - 절벽 끝에서 약간의 여유
    JUMP_BUFFER: 100,          // 점프 버퍼 (ms) - 착지 직전 미리 점프 입력

    // 전투
    ATTACK_RANGE: 48,          // 공격 범위 (px)
    ATTACK_COOLDOWN: 400,      // 공격 쿨다운 (ms)
    INVINCIBLE_TIME: 1000,     // 피격 후 무적 시간 (ms)
    KNOCKBACK_FORCE: 200,      // 넉백 힘
};
```

---

## 6. 전투 시스템

### 6.1 기본 전투 메카닉

#### 공격
- **기본 공격 (Attack-01):** 전방 검 베기, 8프레임 애니메이션
- **공격 판정:** 애니메이션 3~5프레임에서 히트박스 활성화
- **히트 이펙트:** 적 피격 시 화면 흔들림(Screen Shake) + 히트스탑(60ms 정지) + 넉백
- **콤보:** 기본 공격을 연속 입력하면 2타 콤보 (추후 3타까지 확장 가능)

#### 피격 & 회피
- **피격:** 플레이어 깜빡임 + 1초 무적 + 넉백
- **회피:** 점프로 회피하거나, 이중 점프로 적 머리 위를 넘어감
- **체력 0:** Die 애니메이션(8프레임) 재생 후 마지막 체크포인트에서 부활

### 6.2 데미지 공식

```
최종 데미지 = (기본 공격력 + 무기 공격력) × (1 + 크리티컬 배율) - 적 방어력
```

| 스탯 | 설명 | 기본값 |
|------|------|--------|
| ATK (공격력) | 기본 물리 데미지 | 10 |
| DEF (방어력) | 받는 데미지 감소 | 5 |
| HP (체력) | 생명력 | 100 |
| CRT (크리티컬) | 치명타 확률 (%) | 5% |
| SPD (속도) | 이동 속도 보정 | 100% |

### 6.3 전투 피드백 연출

```
적 피격 시 연출 순서 (프레임 단위):

Frame 0:  공격 히트박스가 적과 충돌
Frame 1:  히트스탑 (게임 60ms 정지) ← 타격감의 핵심!
Frame 2:  카메라 쉐이크 (2px, 100ms)
Frame 3:  적 스프라이트 하얀색 플래시 (White 스프라이트 교체)
Frame 4:  데미지 숫자 팝업 (위로 튀어오르며 페이드아웃)
Frame 5:  적 넉백 이동 시작
Frame 6:  파티클 이펙트 (작은 흰 입자 방사)
```

> **에셋 활용:** 멧돼지의 `Hit-Sheet-White.png`를 피격 플래시로 사용!

---

## 7. 몬스터 시스템

### 7.1 멧돼지 (Wild Boar)

**역할:** 근접 돌진형 몬스터 (가장 기본적인 적)

| 레벨 | HP | ATK | DEF | EXP | 출현 구역 |
|------|----|-----|-----|-----|-----------|
| 1 | 30 | 8 | 2 | 15 | 울창한 숲 |
| 3 | 50 | 14 | 5 | 30 | 울창한 숲 깊은 곳 |
| 5 | 80 | 22 | 8 | 55 | 고대 유적 |
| 7 | 120 | 30 | 12 | 85 | 고대 유적 심층 |
| 9 | 180 | 40 | 18 | 130 | 호수 지대 (엘리트) |

**AI 행동 패턴:**

```
상태 머신:
                              플레이어 감지
  [IDLE] ──────────────────────────────→ [WALK → 접근]
  (4프레임, 제자리)                         │
       ↑                                    │ 사거리 도달
       │                                    ▼
       │ 쿨다운                        [RUN → 돌진!]
       │                              (6프레임, 빠른 돌격)
       │                                    │
       │                                    │ 충돌 or 벽
       │                                    ▼
       └──────────────────────────── [스턴 (1초 경직)]
```

- **Idle:** 좌우를 느리게 두리번거림
- **Walk:** 플레이어 탐지 시(반경 120px) 천천히 접근
- **Run:** 공격 사거리(80px) 진입 시 돌진 공격
- **Hit-Vanish:** 피격 시 하얀 플래시 → 사망 시 사라짐
- **특수 색상:** Black 변종(방어력↑), White 변종(속도↑) - 에셋의 색상 변형 활용

**드롭 아이템:**

| 아이템 | 확률 | 용도 |
|--------|------|------|
| 멧돼지 엄니 | 60% | 무기 조합 재료 |
| 질긴 가죽 | 40% | 방어구 조합 재료 |
| 멧돼지 고기 | 30% | 체력 포션 재료 |

### 7.2 달팽이 (Snail)

**역할:** 방어형/기습형 몬스터

| 레벨 | HP | ATK | DEF | EXP | 출현 구역 |
|------|----|-----|-----|-----|-----------|
| 1 | 20 | 5 | 8 | 10 | 울창한 숲 |
| 3 | 40 | 10 | 15 | 25 | 깊은 동굴 |
| 5 | 65 | 18 | 25 | 50 | 깊은 동굴 심층 |

**AI 행동 패턴:**

```
  [WALK] ←────── 플레이어 멀어짐 ─────── [HIDE]
  (8프레임, 느린 순찰)                    (8프레임, 껍데기 숨기)
       │                                    ↑
       │ 플레이어 접근 (50px)               │ 공격 받음
       ▼                                    │
  [HIDE] ──── 껍데기 상태에서 방어력 3배 ───┘
       │
       │ 플레이어가 등 뒤에 있을 때
       ▼
  [APPEAR → 기습 공격!]
       │
       │ HP 0
       ▼
  [DIE] (8프레임, 껍데기에서 빠져나오며 사망)
```

- **핵심 메카닉:** 껍데기에 숨은 상태에서는 데미지 1/3로 감소
- **공략법:** 등 뒤로 돌아가서 공격하면 즉시 APPEAR 상태로 전환 → 취약
- **동굴 기습:** 어두운 동굴에서 바위처럼 위장, 접근하면 갑자기 출현

**드롭 아이템:**

| 아이템 | 확률 | 용도 |
|--------|------|------|
| 달팽이 껍데기 | 50% | 방어구 조합 재료 |
| 끈적한 점액 | 40% | 포션 조합 재료 |
| 작은 진주 | 10% | 희귀 액세서리 재료 |

### 7.3 작은 꿀벌 (Small Bee)

**역할:** 공중 원거리/돌격형 몬스터

| 레벨 | HP | ATK | DEF | EXP | 출현 구역 |
|------|----|-----|-----|-----|-----------|
| 4 | 25 | 18 | 3 | 35 | 고대 유적 |
| 6 | 45 | 28 | 5 | 60 | 호수 지대 |
| 8 | 70 | 38 | 8 | 95 | 벌집 둥지 |
| 10 | 100 | 50 | 12 | 150 | 벌집 둥지 심층 |

**AI 행동 패턴:**

```
  [FLY] ←────── 미감지 상태 순찰 ──────→ [FLY]
  (4프레임, 사인파 곡선 비행)
       │
       │ 플레이어 감지 (반경 150px)
       ▼
  [FLY → 추적] ──── 상공에서 플레이어 추적
       │
       │ 공격 사거리 (60px)
       ▼
  [ATTACK] ──── 급강하 돌진! (4프레임)
  (4프레임)     데미지 판정 + 자기도 반동
       │
       │ 피격 당함
       ▼
  [HIT] ──── 잠시 경직 (4프레임)
  (4프레임)     이후 다시 FLY로 복귀
```

- **비행 패턴:** 사인파 곡선으로 부드럽게 비행 (y = sin(time) * amplitude)
- **급강하 공격:** 플레이어 위에서 대각선 돌진 → 높은 데미지
- **약점:** 체력이 낮아서 타이밍 맞추면 한방 가능
- **무리 출현:** 벌집 스테이지에서 3~5마리가 동시에 출현

**드롭 아이템:**

| 아이템 | 확률 | 용도 |
|--------|------|------|
| 벌침 | 55% | 무기 강화 재료 |
| 벌꿀 | 45% | 체력 포션 재료 |
| 로열젤리 | 8% | 고급 포션 재료 (희귀) |

### 7.4 보스: 여왕벌 (Queen Bee) — 확장 설계

에셋에 직접적인 보스 스프라이트는 없지만, **Small Bee 스프라이트를 2~3배 확대**하고
색상을 변경(tint)하여 보스로 활용합니다.

**페이즈 1 (HP 100%~60%):**
- 화면 상단에서 좌우 비행하며 작은 벌 소환 (5초마다 2마리)
- 가끔 급강하 공격

**페이즈 2 (HP 60%~30%):**
- 이동 속도 증가, 꿀 폭탄 투하 (바닥에 슬로우 장판)
- 소환 빈도 증가 (3초마다 3마리)

**페이즈 3 (HP 30%~0%):**
- 분노 모드: 화면 전체를 빠르게 돌진
- 연속 급강하 공격 3회
- 소환 중단하고 직접 전투

---

## 8. 자원 채굴 & 조합 시스템

### 8.1 자원 노드

월드에 배치된 채굴 가능한 오브젝트들:

| 자원 노드 | 에셋 | 출현 구역 | 드롭 자원 | 재생성 시간 |
|-----------|------|-----------|-----------|------------|
| 나무 | Tree-Assets.png | 숲 전역 | 나뭇가지, 목재 | 120초 |
| 약초 | Tiles.png (버섯) | 숲, 호수 | 약초, 독버섯 | 90초 |
| 바위 | Props-Rocks.png (작은 바위) | 전 구역 | 돌, 철광석 | 150초 |
| 광맥 | Props-Rocks.png (큰 바위) | 동굴 | 구리, 은, 금 | 300초 |
| 수정 | Interior-01.png (보석류) | 동굴, 유적 | 수정, 루비, 사파이어 | 600초 |
| 룬 스톤 | Props-Rocks.png (룬 문자) | 유적 | 룬 조각, 마력 결정 | 900초 |
| 벌집 조각 | Hive.png | 벌집 | 밀랍, 로열젤리 | 180초 |

### 8.2 채굴 메카닉

```
플레이어가 자원 노드 앞에서 채굴 키(K) 입력
    │
    ▼
[채굴 게이지 표시] ← 누르고 있는 동안 게이지 채워짐
    │                  (자원 종류별 소요 시간 상이)
    │
    ▼ 게이지 완료
[채굴 성공!]
    ├─ 자원 아이템이 튀어나오는 파티클 연출
    ├─ 인벤토리에 자동 추가
    ├─ 자원 노드 파괴 애니메이션
    └─ 일정 시간 후 자원 노드 재생성
```

- **채굴 중 취약:** 채굴 중에는 이동 불가, 적에게 맞으면 채굴 중단
- **도구 레벨:** 기본 곡괭이 → 철 곡괭이 → 금 곡괭이 (높은 등급 자원 채굴 가능)

### 8.3 조합 시스템

#### 조합 카테고리

```
┌─────────────────────────────────────────────┐
│              🔨 조합대 (Crafting Table)       │
├─────────┬─────────┬─────────┬───────────────┤
│ ⚔️ 무기  │ 🛡️ 방어구│ 🧪 포션  │ 🔧 도구       │
└─────────┴─────────┴─────────┴───────────────┘
```

#### 무기 레시피

| 무기 | 재료 | ATK | 특수 효과 |
|------|------|-----|-----------|
| 나무 검 (기본) | - | +5 | 없음 |
| 돌 검 | 나뭇가지×3 + 돌×5 | +10 | 없음 |
| 철 검 | 철광석×5 + 목재×3 | +18 | 없음 |
| 멧돼지 엄니 검 | 철 검 + 멧돼지 엄니×8 | +25 | 멧돼지에게 데미지 +20% |
| 수정 검 | 금×5 + 수정×3 + 루비×1 | +35 | 크리티컬 확률 +10% |
| 벌침 단검 | 벌침×10 + 로열젤리×2 | +30 | 공격 속도 +20%, 독 데미지 |
| 룬 대검 | 룬 조각×5 + 마력 결정×3 + 금×8 | +50 | 공격 시 마법 파동 추가 |

#### 방어구 레시피

| 방어구 | 재료 | DEF | 특수 효과 |
|--------|------|-----|-----------|
| 천 갑옷 (기본) | - | +3 | 없음 |
| 가죽 갑옷 | 질긴 가죽×5 + 끈적한 점액×2 | +8 | 없음 |
| 달팽이 갑옷 | 달팽이 껍데기×8 + 철광석×3 | +15 | 피격 시 10% 확률 데미지 반사 |
| 철 갑옷 | 철광석×10 + 구리×5 | +20 | 없음 |
| 수정 갑옷 | 수정×5 + 사파이어×2 + 금×5 | +30 | 마법 데미지 -20% |
| 황금 갑옷 | 금×15 + 루비×3 + 로열젤리×3 | +40 | HP +50, 자동 회복 1/5초 |

#### 포션 레시피

| 포션 | 재료 | 효과 |
|------|------|------|
| 작은 체력 포션 | 약초×2 + 벌꿀×1 | HP +30 |
| 중간 체력 포션 | 약초×3 + 벌꿀×2 + 멧돼지 고기×1 | HP +80 |
| 큰 체력 포션 | 약초×5 + 로열젤리×1 + 수련잎×2 | HP +200 |
| 힘의 포션 | 독버섯×2 + 벌침×3 | ATK +30% (30초) |
| 철벽 포션 | 달팽이 점액×3 + 철광석×2 | DEF +50% (30초) |
| 신속 포션 | 벌꿀×3 + 수련잎×2 | SPD +40% (20초) |

#### 도구 레시피

| 도구 | 재료 | 효과 |
|------|------|------|
| 철 곡괭이 | 나뭇가지×2 + 철광석×5 | 구리/은 광맥 채굴 가능 |
| 금 곡괭이 | 철 곡괭이 + 금×8 + 수정×2 | 금/보석 채굴 가능 |
| 횃불 | 나뭇가지×3 + 끈적한 점액×2 | 동굴 시야 확장 |
| 낚싯대 | 나뭇가지×5 + 끈적한 점액×3 | 호수에서 낚시 가능 |

### 8.4 인벤토리 시스템

```
┌─────────────────────────────────────┐
│         인벤토리 (20칸)              │
├────┬────┬────┬────┬────┬────┬────┬──┤
│ 🪵  │ ⛏️  │ 💎  │ 🌿  │ 🍖  │ 🧪  │    │  │
│x12 │x5  │x3  │x8  │x2  │x4  │    │  │
├────┼────┼────┼────┼────┼────┼────┼──┤
│    │    │    │    │    │    │    │  │
│    │    │    │    │    │    │    │  │
├────┴────┴────┴────┴────┴────┴────┴──┤
│  [장비 슬롯]                         │
│  무기: [철 검]    방어구: [가죽 갑옷]  │
│  도구: [철 곡괭이] 포션: [체력 포션x3] │
└─────────────────────────────────────┘
```

- **최대 20칸** (확장 가능: 가방 조합으로 30칸까지)
- **자원 스택:** 같은 자원은 99개까지 스택
- **퀵슬롯:** 포션 3개까지 바로 사용 (숫자키 1~3)

---

## 9. 성장 시스템

### 9.1 레벨업

| 레벨 | 필요 EXP | 누적 EXP | HP | ATK | DEF | 해금 요소 |
|------|----------|----------|-----|-----|-----|-----------|
| 1 | 0 | 0 | 100 | 10 | 5 | 기본 공격 |
| 2 | 100 | 100 | 115 | 12 | 6 | 이중 점프 |
| 3 | 250 | 350 | 130 | 14 | 7 | 동굴 입장 |
| 4 | 450 | 800 | 150 | 17 | 9 | 콤보 공격 |
| 5 | 700 | 1500 | 170 | 20 | 11 | 유적 입장 |
| 6 | 1000 | 2500 | 195 | 24 | 13 | 채굴 속도 UP |
| 7 | 1400 | 3900 | 220 | 28 | 16 | 호수 입장 |
| 8 | 1900 | 5800 | 250 | 33 | 19 | 공중 공격 강화 |
| 9 | 2500 | 8300 | 285 | 38 | 22 | 벌집 입장 |
| 10 | 3200 | 11500 | 320 | 44 | 26 | 궁극기 해금 |

### 9.2 스킬 트리

레벨업 시 **스킬 포인트 1점**을 획득하여 3개 분기 중 선택:

```
                    [전사의 길]
                         │
          ┌──────────────┼──────────────┐
          │              │              │
     ⚔️ 공격 분기    🛡️ 방어 분기    ⛏️ 채집 분기
          │              │              │
     Lv2: 강타       Lv2: 방패 막기  Lv2: 빠른 채굴
     (ATK+15%)      (DEF+20%)       (채굴속도+30%)
          │              │              │
     Lv4: 연속베기   Lv4: 반격       Lv4: 행운
     (3타 콤보)     (패링 시 반격)   (드롭률+20%)
          │              │              │
     Lv6: 회전베기   Lv6: 체력 강화  Lv6: 자원 감정
     (범위 공격)    (HP+30%)        (희귀자원 발견)
          │              │              │
     Lv8: 검기 발사  Lv8: 불굴      Lv8: 마스터 조합
     (원거리 공격)  (HP1로 생존)    (조합 보너스+50%)
          │              │              │
     Lv10: 폭풍검   Lv10: 철벽     Lv10: 연금술
     (궁극기)      (궁극기)        (궁극기)
```

### 9.3 장비 강화

조합대에서 **같은 장비 + 강화석**으로 장비를 강화할 수 있습니다:

```
철 검 +0 → [철광석×3] → 철 검 +1 (ATK +2)
철 검 +1 → [철광석×5] → 철 검 +2 (ATK +4)
철 검 +2 → [금×3]     → 철 검 +3 (ATK +7, 이펙트 추가)
                               └→ 검에 빛나는 효과!
```

- **+3 이상:** 무기에 빛나는 파티클 이펙트 추가
- **+5 최대:** 무기 외형 색상 변경 (golden tint)

---

## 10. HUD & UI 설계

### 10.1 인게임 HUD 레이아웃

에셋의 `Base-01.png` (다양한 색상/형태의 바, 아이콘, 프레임)을 활용:

```
┌─────────────────────────────────────────────────────────┐
│ ┌──────────────┐                    ┌────────────────┐  │
│ │ [캐릭터 초상] │                    │  ⛏️ 1  🧪 2  🗡️ 3│  │
│ │   Lv.5       │                    │   퀵 슬롯      │  │
│ ├──────────────┤                    └────────────────┘  │
│ │ ❤️ ████████░░ │ HP 170/170                            │
│ │ ⭐ ██████░░░░ │ EXP 450/700                           │
│ └──────────────┘                                        │
│                                                         │
│                                                         │
│                    << 게임 화면 >>                        │
│                                                         │
│                                                         │
│                                           ┌───┐         │
│                                           │ 📦│ 인벤토리  │
│                                           │ 🔨│ 조합     │
│ ┌──────────────────┐                      │ 📊│ 스탯     │
│ │ 🪙 Gold: 1,250    │                      └───┘         │
│ └──────────────────┘                                    │
└─────────────────────────────────────────────────────────┘
```

### 10.2 UI 색상 체계 (Base-01.png 에셋 활용)

| 용도 | 색상 | HUD 에셋 매핑 |
|------|------|--------------|
| HP 바 | 빨간색 계열 | Base-01.png 빨간 바 |
| EXP 바 | 노란색 계열 | Base-01.png 노란 바 |
| 채굴 게이지 | 파란색 계열 | Base-01.png 파란 바 |
| 보스 HP 바 | 보라색 계열 | Base-01.png (커스텀) |
| 버프 아이콘 | 초록색 프레임 | Base-01.png 초록 도형 |
| 디버프 아이콘 | 빨간색 프레임 | Base-01.png 빨간 도형 |
| 메뉴 버튼 | 갈색 나무 프레임 | Base-01.png 나무 프레임 |
| 인벤토리 슬롯 | 갈색 사각형 | Base-01.png 갈색 사각 |

### 10.3 모바일 터치 UI

```
┌─────────────────────────────────────────────────┐
│  [HP바] [EXP바]                    [Pause] [Inv]│
│                                                  │
│                                                  │
│                   게임 화면                       │
│                                                  │
│                                                  │
│  ┌───┐                          ┌───┐  ┌───┐   │
│  │ ◀ │ ┌───┐            ┌───┐  │ B │  │ A │   │
│  └───┘ │ ▶ │            │ Y │  │채굴│  │공격│   │
│        └───┘            │점프│  └───┘  └───┘   │
│                         └───┘                   │
└─────────────────────────────────────────────────┘
```

---

## 11. 사운드 & 이펙트

### 11.1 효과음 목록 (필요 제작/소싱)

| 카테고리 | 사운드 | 트리거 |
|----------|--------|--------|
| **플레이어** | 검 휘두름 (쉬익) | 공격 시 |
| | 발소리 (풀/돌/나무) | 이동 시 (지형별 다름) |
| | 점프 (흡!) | 점프 시 |
| | 착지 (쿵) | 착지 시 |
| | 피격 (억!) | 데미지 받을 때 |
| | 사망 (쓰러짐) | HP 0 |
| **적** | 멧돼지 돌진 (꿀꿀!) | 돌진 시작 |
| | 벌 윙윙 (부우웅) | 비행 중 |
| | 달팽이 껍데기 (딸깍) | 숨을 때 |
| | 적 사망 (펑) | 처치 시 |
| **시스템** | 아이템 획득 (띠링) | 아이템 획득 |
| | 채굴 (깡깡) | 채굴 중 |
| | 조합 성공 (짜잔) | 조합 완료 |
| | 레벨업 (팡파레) | 레벨업 |
| | 체크포인트 (따다다) | 저장 |

### 11.2 파티클 이펙트 (코드로 구현)

| 이펙트 | 구현 방법 |
|--------|-----------|
| 먼지 구름 | 착지/돌진 시 작은 원형 파티클 방출 |
| 나뭇잎 | 숲 스테이지 전경에 떨어지는 나뭇잎 |
| 물방울 | 동굴 천장에서 떨어지는 물방울 |
| 히트 스파크 | 공격 적중 시 방사형 흰 입자 |
| 채굴 파편 | 채굴 시 작은 돌 조각 튀어오름 |
| 경험치 오브 | 적 처치 시 빛나는 구슬 → 플레이어에게 흡수 |
| 레벨업 광채 | 캐릭터 중심 원형 빛 확산 |

---

## 12. 데이터 저장 & 배포

### 12.1 세이브 시스템

**자동 저장 트리거:**
- 스테이지 전환 시
- 보스 처치 시
- 조합 완료 시
- 60초마다 자동 저장

**저장 데이터 구조:**
```json
{
  "version": "1.0",
  "player": {
    "name": "Hero",
    "level": 5,
    "exp": 450,
    "hp": 170,
    "maxHp": 170,
    "stats": { "atk": 20, "def": 11, "crt": 5, "spd": 100 },
    "position": { "scene": "ForestScene", "x": 1200, "y": 400 },
    "skills": ["doubleJump", "comboAttack"],
    "skillPoints": 1
  },
  "inventory": {
    "items": [
      { "id": "iron_ore", "qty": 15 },
      { "id": "herb", "qty": 8 }
    ],
    "equipment": {
      "weapon": "iron_sword_+2",
      "armor": "leather_armor",
      "tool": "iron_pickaxe"
    }
  },
  "progress": {
    "unlockedAreas": ["forest", "cave", "ruins"],
    "bossesDefeated": [],
    "discoveredRecipes": ["stone_sword", "iron_sword", "health_potion_s"],
    "checkpoints": ["forest_entrance", "cave_entrance"]
  },
  "playtime": 3600,
  "lastSaved": "2026-02-19T14:30:00Z"
}
```

**저장소:**
1. **Primary:** `localStorage` (즉시, 오프라인 가능)
2. **Backup:** `IndexedDB` (더 큰 용량, 구조화된 데이터)
3. **Optional Cloud:** Firebase Realtime DB 또는 Supabase (기기 간 동기화)

### 12.2 배포 파이프라인

```
[개발] ──→ [테스트] ──→ [배포] ──→ [플레이어]

구체적 흐름:
1. 로컬에서 개발: vite dev (핫리로드)
2. 빌드: vite build (최적화, 트리쉐이킹)
3. Git push → GitHub
4. Vercel/Netlify 자동 감지 → 빌드 → CDN 배포
5. 커스텀 도메인 연결 (선택)
6. 플레이어는 URL 접속만으로 최신 버전 플레이
```

**PWA 설정:**
```json
{
  "name": "Hero in the Dark",
  "short_name": "HITD",
  "start_url": "/",
  "display": "fullscreen",
  "orientation": "landscape",
  "theme_color": "#1a1a2e",
  "background_color": "#0f0f23",
  "icons": [{ "src": "/icon-192.png", "sizes": "192x192" }]
}
```

---

## 13. 에셋 매핑 테이블

현재 보유한 에셋과 게임 요소의 1:1 매핑:

### 캐릭터 스프라이트

| 게임 동작 | 에셋 파일 | 프레임 수 | 크기(추정) |
|-----------|-----------|-----------|-----------|
| 대기 | `Character/Idle/Idle-Sheet.png` | 4 | 64×64/frame |
| 달리기 | `Character/Run/Run-Sheet.png` | 8 | 80×64/frame |
| 공격 | `Character/Attack-01/Attack-01-Sheet.png` | 8 | 96×64/frame |
| 점프 시작 | `Character/Jump-Start/Jump-Start-Sheet.png` | 4 | 64×64/frame |
| 공중 | `Character/Jumlp-All/Jump-All-Sheet.png` | 8+4 | 64×64/frame |
| 착지 | `Character/Jump-End/Jump-End-Sheet.png` | 4 | 64×64/frame |
| 사망 | `Character/Dead/Dead-Sheet.png` | 8 | 80×64/frame |

### 몬스터 스프라이트

| 몬스터 | 동작 | 에셋 파일 | 색상 변형 |
|--------|------|-----------|-----------|
| 멧돼지 | 대기 | `Mob/Boar/Idle/Idle-Sheet.png` | Normal, White |
| 멧돼지 | 걷기 | `Mob/Boar/Walk/Walk-Base-Sheet.png` | Normal, Black, White |
| 멧돼지 | 돌진 | `Mob/Boar/Run/Run-Sheet.png` | Normal, Black, White |
| 멧돼지 | 피격 | `Mob/Boar/Hit-Vanish/Hit-Sheet.png` | Normal, Black, White |
| 꿀벌 | 비행 | `Mob/Small Bee/Fly/Fly-Sheet.png` | - |
| 꿀벌 | 공격 | `Mob/Small Bee/Attack/Attack-Sheet.png` | - |
| 꿀벌 | 피격 | `Mob/Small Bee/Hit/Hit-Sheet.png` | - |
| 달팽이 | 걷기 | `Mob/Snail/walk-Sheet.png` | - |
| 달팽이 | 숨기 | `Mob/Snail/Hide-Sheet.png` | - |
| 달팽이 | 사망 | `Mob/Snail/Dead-Sheet.png` | - |

### 환경 에셋

| 게임 요소 | 에셋 파일 | 용도 |
|-----------|-----------|------|
| 타일맵 | `Assets/Tiles.png` | 숲/유적/호수/동굴 지형 |
| 배경 하늘 | `Background/Background.png` | 패럴랙스 Layer 0 |
| 배경 나무 | `Trees/Background.png` | 패럴랙스 Layer 1-2 |
| 나무 (초록) | `Trees/Green-Tree.png` | 숲 스테이지 |
| 나무 (어두운) | `Trees/Dark-Tree.png` | 숲 깊은 곳 |
| 나무 (금색) | `Trees/Golden-Tree.png` | 호수 스테이지 |
| 나무 (빨강) | `Trees/Red-Tree.png` | 유적 스테이지 |
| 나무 (노랑) | `Trees/Yellow-Tree.png` | 호수 스테이지 |
| 건물/광산 | `Assets/Buildings.png` | 마을/거점/광산 입구 |
| 바위/룬 | `Assets/Props-Rocks.png` | 채굴 노드, 장식 |
| 벌집 | `Assets/Hive.png` | 벌집 스테이지 타일 |
| 나무 디테일 | `Assets/Tree-Assets.png` | 나무 기둥, 잎, 수풀 |
| 실내 | `Assets/Interior-01.png` | 상점/거점 인테리어, 보석 아이콘 |
| HUD | `HUD/Base-01.png` | HP바, EXP바, 아이콘, 프레임 |

---

## 14. 개발 로드맵

### Phase 1: 프로토타입 (1~2주)
- [x] 에셋 확보 및 분석 ← **현재 완료!**
- [ ] Phaser 3 + Vite 프로젝트 초기 설정
- [ ] 캐릭터 이동/점프/공격 기본 구현
- [ ] 숲 스테이지 타일맵 1개 제작 (Tiled Editor)
- [ ] 멧돼지 AI 기본 구현
- [ ] 기본 충돌 및 데미지 시스템

### Phase 2: 핵심 시스템 (2~3주)
- [ ] 인벤토리 시스템
- [ ] 채굴 시스템
- [ ] 기본 조합 시스템 (무기 3종 + 포션 2종)
- [ ] 달팽이 & 꿀벌 AI 구현
- [ ] HUD 완성 (HP, EXP, 퀵슬롯)
- [ ] 세이브/로드 시스템

### Phase 3: 콘텐츠 확장 (3~4주)
- [ ] 동굴, 유적, 호수, 벌집 스테이지
- [ ] 전체 조합 레시피 구현
- [ ] 성장/레벨업 시스템
- [ ] 스킬 트리
- [ ] 여왕벌 보스 전투
- [ ] 패럴랙스 배경 완성

### Phase 4: 폴리시 & 출시 (1~2주)
- [ ] 효과음 & BGM 추가
- [ ] 파티클 이펙트 (먼지, 나뭇잎, 히트스파크)
- [ ] 히트스탑 & 카메라 쉐이크 타격감
- [ ] 모바일 터치 UI
- [ ] PWA 설정
- [ ] Vercel 배포 & 도메인 연결
- [ ] 성능 최적화 & QA

---

## 부록: 게임 밸런스 핵심 원칙

1. **10초 규칙:** 10초마다 플레이어에게 무언가 일어나야 한다 (적 출현, 자원 발견, 레벨업 등)
2. **3번의 법칙:** 플레이어가 같은 실수로 3번 죽으면 힌트를 제공한다
3. **기하급수적 보상:** 어려운 구역일수록 자원 드롭 양이 급격히 증가
4. **안전지대:** 각 스테이지 시작점에 몬스터 없는 안전 구역 (긴장 → 이완 리듬)
5. **선택의 자유:** 공격/방어/채집 분기 중 어떤 것을 먼저 올려도 클리어 가능

---

> **"어둠 속의 영웅은 혼자가 아니다. 플레이어의 선택이 곧 빛이 된다."**
>
> *— Hero in the Dark, 2026*
